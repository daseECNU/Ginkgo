SELECT
        L_ORDERKEY,
        SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
        O_ORDERDATE,
        O_SHIPPRIORITY
FROM
        LINEITEM,
        ORDERS,
        CUSTOMER
WHERE
        C_MKTSEGMENT = 'HOUSEHOLD'
        AND C_CUSTKEY = O_CUSTKEY
        AND L_ORDERKEY = O_ORDERKEY
        AND O_ORDERDATE < '1995-03-04'
        AND L_SHIPDATE > '1995-03-04'
GROUP BY
        L_ORDERKEY,
        O_ORDERDATE,
        O_SHIPPRIORITY
ORDER BY
	L_ORDERKEY,
        REVENUE DESC,
        O_ORDERDATE,
	O_SHIPPRIORITY;
exit;
